<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë…¸ì…˜ API í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .profile-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            background: #fafafa;
        }
        .profile-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        .profile-image {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff98a8, #ffd6e9);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 20px;
        }
        .profile-info h3 {
            margin: 0 0 5px 0;
            color: #333;
        }
        .profile-info p {
            margin: 0;
            color: #666;
        }
        .tags {
            margin: 10px 0;
        }
        .tag {
            display: inline-block;
            background: #007bff;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            margin: 2px;
        }
        .loading {
            text-align: center;
            padding: 50px;
            color: #666;
        }
        .error {
            background: #ffe6e6;
            border: 1px solid #ffcccc;
            color: #cc0000;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
        }
        .btn:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒŸ ë…¸ì…˜ ì—ì½”ê±¸ í”„ë¡œí•„ í…ŒìŠ¤íŠ¸</h1>
        
        <div style="text-align: center; margin-bottom: 20px;">
            <button class="btn" onclick="loadProfiles()">í”„ë¡œí•„ ë¡œë“œ</button>
            <button class="btn" onclick="testSingleProfile()">ê°œë³„ í”„ë¡œí•„ í…ŒìŠ¤íŠ¸</button>
        </div>
        
        <div id="result">
            <div class="loading">ë²„íŠ¼ì„ í´ë¦­í•´ì„œ ë…¸ì…˜ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì„¸ìš”!</div>
        </div>
    </div>

    <!-- ë…¸ì…˜ API ìŠ¤í¬ë¦½íŠ¸ (í”„ë¡ì‹œ ë²„ì „) -->
    <script src="assets/js/notion-api-proxy.js"></script>
    
    <script>
        let notionAPI = null;
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ API ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            try {
                notionAPI = new NotionAPI();
                console.log('âœ… ë…¸ì…˜ API ì´ˆê¸°í™” ì™„ë£Œ');
            } catch (error) {
                console.error('âŒ ë…¸ì…˜ API ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
                showError('ë…¸ì…˜ API ì´ˆê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        });
        
        // ëª¨ë“  í”„ë¡œí•„ ë¡œë“œ
        async function loadProfiles() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<div class="loading">ë…¸ì…˜ì—ì„œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>';
            
            try {
                console.log('ğŸ”„ ë…¸ì…˜ í”„ë¡œí•„ ë¡œë“œ ì‹œì‘...');
                const profiles = await notionAPI.getAllProfiles();
                console.log('ğŸ“„ ë¡œë“œëœ í”„ë¡œí•„:', profiles);
                
                if (profiles.length === 0) {
                    resultDiv.innerHTML = '<div class="error">í™œì„± ìƒíƒœì˜ í”„ë¡œí•„ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
                    return;
                }
                
                let html = `<h3>ì´ ${profiles.length}ê°œì˜ í”„ë¡œí•„ì„ ì°¾ì•˜ìŠµë‹ˆë‹¤!</h3>`;
                
                profiles.forEach(profile => {
                    html += createProfileCard(profile);
                });
                
                resultDiv.innerHTML = html;
                
            } catch (error) {
                console.error('âŒ í”„ë¡œí•„ ë¡œë“œ ì‹¤íŒ¨:', error);
                showError(`í”„ë¡œí•„ ë¡œë“œ ì‹¤íŒ¨: ${error.message}`);
            }
        }
        
        // ê°œë³„ í”„ë¡œí•„ í…ŒìŠ¤íŠ¸
        async function testSingleProfile() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<div class="loading">ID 1ë²ˆ í”„ë¡œí•„ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>';
            
            try {
                const profile = await notionAPI.getProfile(1);
                console.log('ğŸ‘¤ ê°œë³„ í”„ë¡œí•„:', profile);
                
                if (!profile) {
                    resultDiv.innerHTML = '<div class="error">ID 1ë²ˆ í”„ë¡œí•„ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>';
                    return;
                }
                
                let html = '<h3>ê°œë³„ í”„ë¡œí•„ í…ŒìŠ¤íŠ¸ (ID: 1)</h3>';
                html += createProfileCard(profile);
                
                resultDiv.innerHTML = html;
                
            } catch (error) {
                console.error('âŒ ê°œë³„ í”„ë¡œí•„ ë¡œë“œ ì‹¤íŒ¨:', error);
                showError(`ê°œë³„ í”„ë¡œí•„ ë¡œë“œ ì‹¤íŒ¨: ${error.message}`);
            }
        }
        
        // í”„ë¡œí•„ ì¹´ë“œ HTML ìƒì„±
        function createProfileCard(profile) {
            const languages = profile.languages.map(lang => `<span class="tag">${lang}</span>`).join('');
            const hobbies = profile.hobbies.map(hobby => `<span class="tag">${hobby}</span>`).join('');
            const skills = profile.skills.map(skill => `<span class="tag">${skill}</span>`).join('');
            const personality = profile.personality.map(p => `<span class="tag">${p}</span>`).join('');
            
            return `
                <div class="profile-card">
                    <div class="profile-header">
                        <div class="profile-image">
                            ${profile.name}
                        </div>
                        <div class="profile-info">
                            <h3>${profile.name} (${profile.age}ì„¸)</h3>
                            <p>ID: ${profile.id} | ìƒíƒœ: ${profile.status}</p>
                            <p>ì—°ë½ì²˜: ${profile.contact}</p>
                            ${profile.phone ? `<p>ì „í™”: ${profile.phone}</p>` : ''}
                        </div>
                    </div>
                    
                    ${profile.introduction ? `<p><strong>ì†Œê°œ:</strong> ${profile.introduction}</p>` : ''}
                    
                    <div class="tags">
                        <strong>ì–¸ì–´:</strong> ${languages || '<span class="tag">ì—†ìŒ</span>'}
                    </div>
                    
                    <div class="tags">
                        <strong>ì·¨ë¯¸:</strong> ${hobbies || '<span class="tag">ì—†ìŒ</span>'}
                    </div>
                    
                    <div class="tags">
                        <strong>ì„±í–¥:</strong> ${personality || '<span class="tag">ì—†ìŒ</span>'}
                    </div>
                    
                    <div class="tags">
                        <strong>íŠ¹ê¸°:</strong> ${skills || '<span class="tag">ì—†ìŒ</span>'}
                    </div>
                    
                    ${profile.mainImage ? `<p><strong>í”„ë¡œí•„ ì´ë¯¸ì§€:</strong> <a href="${profile.mainImage}" target="_blank">ë³´ê¸°</a></p>` : ''}
                    
                    <button class="btn" onclick="goToDetail(${profile.id})">ìƒì„¸ í˜ì´ì§€ë¡œ ì´ë™</button>
                </div>
            `;
        }
        
        // ì—ëŸ¬ í‘œì‹œ
        function showError(message) {
            document.getElementById('result').innerHTML = `<div class="error">${message}</div>`;
        }
        
        // ìƒì„¸ í˜ì´ì§€ë¡œ ì´ë™
        function goToDetail(profileId) {
            window.open(`ecogirl/detail.html?id=${profileId}`, '_blank');
        }
    </script>
</body>
</html>